# Nice Bus-T4 Example Configuration
# For use with Nice BiDi-WiFi module or custom ESP32 hardware

esphome:
  name: gate
  friendly_name: Gate

esp32:
  board: esp32dev
  framework:
    type: esp-idf

logger:
  baud_rate: 0  # Disable serial logging (UART is used for Bus-T4)

api:

ota:
  - platform: esphome

wifi:
  ssid: !secret wifi_ssid
  password: !secret wifi_password
  ap:
    ssid: "Gate Fallback"
    password: "fallback123"

web_server:
  port: 80

external_components:
  - source: components

# UART configuration for Bus-T4
# BiDi-WiFi: GPIO21 (TX), GPIO18 (RX)
# Custom hardware: adjust pins as needed
uart:
  tx_pin: GPIO21
  rx_pin: GPIO18
  baud_rate: 19200

bus_t4:
  id: bus

cover:
  - platform: bus_t4
    name: "Gate"
    id: gate
    auto_learn_timing: true
    open_duration: 20s
    close_duration: 20s
    position_report_interval: 1s

# Optional: Additional buttons for partial opening
button:
  - platform: template
    name: "Partial Open 1"
    icon: "mdi:gate-arrow-right"
    on_press:
      - lambda: id(gate).send_cmd(CMD_OPEN_PARTIAL_1);

  - platform: template
    name: "Step-by-Step"
    icon: "mdi:gate"
    on_press:
      - lambda: id(gate).send_cmd(CMD_STEP);

